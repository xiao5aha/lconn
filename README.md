# lconn长连接通用平台
## 介绍
 长连接通用平台是基于netty4.0技术，提供客户端和业务端消息交互的长连接平台。
 主要应用于这种场景：业务端需要向客户端（可以是手机终端也可以是浏览器）单点或群组性的推送在线长连接消息。
## 项目结构
本着面向对象的思想，项目主要由以下几个重要对象组成：
* node节点，位于node包，代表每台部署了lconn的机器，用于与其他端建立长连接
* channel长连接，位于channel包，代表长连接对象，提供长连接的相关功能
* topic主题，位于topic包，共长连接订阅
* redis缓存，位于cache包，缓存主题与消息，主题与节点等之间的关系
* localcache缓存，位于cache包，本地缓存，缓存长连接
* message消息，位于message包，基于protobuf，是平台与其他端交互的媒介

## 基本流程
* 客户端发送http请求到长连接平台请求建立长连接
* 长连接平台返回机器IP和端口
* 客户端通过IP和端口与平台某台机器建立socket长连接
* 平台完成长连接注册
* 客户端向平台订阅主题
* 平台保存长连接与主题之间的关系并进行缓存
* 业务端向平台的某个主题发送消息
* 如果主题对应的长连接在线，直接发送；如果主题对应的长连接不在线，redis缓存该消息待客户端上线发送